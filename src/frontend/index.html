<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover, interactive-widget=resizes-content"
        />

        <meta name="description" content="Chat with Claude AI assistant" />
        <link rel="icon" type="image/svg+xml" href="./assets/logo.svg" />

        <!-- PWA Meta Tags -->
        <link rel="manifest" href="./manifest.json" />
        <meta name="theme-color" content="#000000" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="Claude" />
        <link rel="apple-touch-icon" href="./assets/icon-180.png" />

        <title>Claude Chat</title>

        <!-- Theme initialization - prevents FOUC -->
        <script>
            (() => {
                try {
                    const storageKey = "claudet-ui-theme";
                    const theme = localStorage.getItem(storageKey);
                    const systemPrefersDark = window.matchMedia(
                        "(prefers-color-scheme: dark)",
                    ).matches;

                    if (
                        theme === "dark" ||
                        (theme === "system" && systemPrefersDark) ||
                        (!theme && systemPrefersDark)
                    ) {
                        document.documentElement.classList.add("dark");
                    }
                } catch (e) {
                    console.error("Theme initialization failed:", e);
                }
            })();
        </script>

        <!-- Service Worker Registration -->
        <script>
            if ("serviceWorker" in navigator) {
                window.addEventListener("load", () => {
                    navigator.serviceWorker
                        .register("/sw.js")
                        .then((registration) => {
                            console.log(
                                "Service Worker registered:",
                                registration.scope,
                            );

                            // Check for updates every 60 seconds
                            setInterval(() => {
                                registration.update();
                            }, 60000);
                        })
                        .catch((error) => {
                            console.error(
                                "Service Worker registration failed:",
                                error,
                            );
                        });
                });
            }
        </script>

        <script type="module" src="./frontend.tsx" async></script>

        <style>
            /* Layout Strategy: interactive-widget=resizes-content with fixed positioning */
            body {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100vh;
                height: 100dvh;
                overflow: hidden;
            }

            #root {
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                /* Use safe area insets for iOS notch/home indicator */
                padding-top: env(safe-area-inset-top, 0);
                padding-bottom: env(safe-area-inset-bottom, 0);
                padding-left: env(safe-area-inset-left, 0);
                padding-right: env(safe-area-inset-right, 0);
            }
        </style>
    </head>
    <body>
        <div id="root"></div>
    </body>
</html>
